  [1m[35mSQL (0.5ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql" SCHEMA pg_catalog[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "recipes" CASCADE[0m
  [1m[35m (4.9ms)[0m  [1m[35mCREATE TABLE "recipes" ("id" bigserial primary key, "title" character varying NOT NULL, "cook_time" integer, "prep_time" integer, "ingredients" text[] DEFAULT '{}', "ratings" decimal(3,2), "cuisine" character varying, "category" character varying, "author" character varying, "image" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE INDEX "index_recipes_on_ingredients" ON "recipes" USING gin ("ingredients")[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20250626185019)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-06-26 20:04:28.042688', '2025-06-26 20:04:28.042690') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'f7a2c7f6a2a8f78c84d656617a3f6c7d75110d47', '2025-06-26 20:04:28.045226', '2025-06-26 20:04:28.045228') RETURNING "key"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(4929869687623764765)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(4929869687623764765)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (4.0ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (980190962, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.263493', '2025-06-26 20:05:17.263493'), (298486374, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.263493', '2025-06-26 20:05:17.263493')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (980190962, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.292127', '2025-06-26 20:05:17.292127'), (298486374, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.292127', '2025-06-26 20:05:17.292127')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (980190962, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.295255', '2025-06-26 20:05:17.295255'), (298486374, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.295255', '2025-06-26 20:05:17.295255')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (980190962, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.298960', '2025-06-26 20:05:17.298960'), (298486374, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, DEFAULT, '2025-06-26 20:05:17.298960', '2025-06-26 20:05:17.298960')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.3ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (981211951, 'My Awesome Recipe', 30, 15, '{salt,pepper}', 4.0, 'General', 'Main Dish', 'Test User', 'https://placehold.co/400x300/F0F8FF/000000?text=Default+Recipe', '2025-06-26 20:14:43.178008', '2025-06-26 20:14:43.178008'), (606571576, 'Simple Soup', 20, 5, '{water,vegetables}', 3.5, 'Vegan', 'Soup', 'Soup Lover', 'https://placehold.co/400x300/F0F8FF/000000?text=Another+Recipe', '2025-06-26 20:14:43.178008', '2025-06-26 20:14:43.178008')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (18.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 981211951]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 606571576]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:14:43.241127"], ["updated_at", "2025-06-26 20:14:43.241127"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:14:43.242473"], ["updated_at", "2025-06-26 20:14:43.242473"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:14:43.243202"], ["updated_at", "2025-06-26 20:14:43.243202"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:14:43.244526"], ["updated_at", "2025-06-26 20:14:43.244526"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 981211951]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 606571576]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:14:43.247311"], ["updated_at", "2025-06-26 20:14:43.247311"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:14:43.248455"], ["updated_at", "2025-06-26 20:14:43.248455"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:14:43.249091"], ["updated_at", "2025-06-26 20:14:43.249091"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:14:43.249732"], ["updated_at", "2025-06-26 20:14:43.249732"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211956], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211959], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211959], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 981211951]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 606571576]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:14:43.257629"], ["updated_at", "2025-06-26 20:14:43.257629"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:14:43.258438"], ["updated_at", "2025-06-26 20:14:43.258438"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:14:43.259169"], ["updated_at", "2025-06-26 20:14:43.259169"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:14:43.259806"], ["updated_at", "2025-06-26 20:14:43.259806"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 981211951]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 606571576]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:14:43.262508"], ["updated_at", "2025-06-26 20:14:43.262508"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:14:43.263342"], ["updated_at", "2025-06-26 20:14:43.263342"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:14:43.264008"], ["updated_at", "2025-06-26 20:14:43.264008"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:14:43.264665"], ["updated_at", "2025-06-26 20:14:43.264665"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211964], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211966], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211967], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211964], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211965], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 981211967], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.2ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:21:32.234886', '2025-06-26 20:21:32.234886'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:21:32.234886', '2025-06-26 20:21:32.234886'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:21:32.234886', '2025-06-26 20:21:32.234886'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:21:32.234886', '2025-06-26 20:21:32.234886')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (11.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.4ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:21:32.282555"], ["updated_at", "2025-06-26 20:21:32.282555"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:21:32.284715"], ["updated_at", "2025-06-26 20:21:32.284715"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:21:32.285484"], ["updated_at", "2025-06-26 20:21:32.285484"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:21:32.286251"], ["updated_at", "2025-06-26 20:21:32.286251"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160650], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.7ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:21:32.295207"], ["updated_at", "2025-06-26 20:21:32.295207"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:21:32.296112"], ["updated_at", "2025-06-26 20:21:32.296112"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:21:32.296820"], ["updated_at", "2025-06-26 20:21:32.296820"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:21:32.297473"], ["updated_at", "2025-06-26 20:21:32.297473"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:21:32.301061"], ["updated_at", "2025-06-26 20:21:32.301061"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:21:32.302660"], ["updated_at", "2025-06-26 20:21:32.302660"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:21:32.304251"], ["updated_at", "2025-06-26 20:21:32.304251"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:21:32.305095"], ["updated_at", "2025-06-26 20:21:32.305095"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160658], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160660], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160661], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160658], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160659], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160661], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:21:32.310300"], ["updated_at", "2025-06-26 20:21:32.310300"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:21:32.310929"], ["updated_at", "2025-06-26 20:21:32.310929"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:21:32.311507"], ["updated_at", "2025-06-26 20:21:32.311507"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:21:32.312078"], ["updated_at", "2025-06-26 20:21:32.312078"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:23:16.786606', '2025-06-26 20:23:16.786606'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:23:16.786606', '2025-06-26 20:23:16.786606'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:23:16.786606', '2025-06-26 20:23:16.786606'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:23:16.786606', '2025-06-26 20:23:16.786606')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (9.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:23:16.830151"], ["updated_at", "2025-06-26 20:23:16.830151"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:23:16.831339"], ["updated_at", "2025-06-26 20:23:16.831339"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:23:16.832094"], ["updated_at", "2025-06-26 20:23:16.832094"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:23:16.832908"], ["updated_at", "2025-06-26 20:23:16.832908"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:23:16.837357"], ["updated_at", "2025-06-26 20:23:16.837357"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:23:16.838111"], ["updated_at", "2025-06-26 20:23:16.838111"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:23:16.838741"], ["updated_at", "2025-06-26 20:23:16.838741"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:23:16.839367"], ["updated_at", "2025-06-26 20:23:16.839367"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160654], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160657], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160657], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:23:16.845665"], ["updated_at", "2025-06-26 20:23:16.845665"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:23:16.846400"], ["updated_at", "2025-06-26 20:23:16.846400"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:23:16.847041"], ["updated_at", "2025-06-26 20:23:16.847041"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:23:16.847669"], ["updated_at", "2025-06-26 20:23:16.847669"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160658], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160660], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160661], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160658], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160659], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160661], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:23:16.852760"], ["updated_at", "2025-06-26 20:23:16.852760"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:23:16.853607"], ["updated_at", "2025-06-26 20:23:16.853607"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:23:16.854286"], ["updated_at", "2025-06-26 20:23:16.854286"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:23:16.855147"], ["updated_at", "2025-06-26 20:23:16.855147"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:27:27.041325', '2025-06-26 20:27:27.041325'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:27:27.041325', '2025-06-26 20:27:27.041325'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:27:27.041325', '2025-06-26 20:27:27.041325'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:27:27.041325', '2025-06-26 20:27:27.041325')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (1.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) /* loading for inspect */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) /* loading for inspect */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:29:19.623770', '2025-06-26 20:29:19.623770'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:29:19.623770', '2025-06-26 20:29:19.623770'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:29:19.623770', '2025-06-26 20:29:19.623770'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:29:19.623770', '2025-06-26 20:29:19.623770')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (1.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) /* loading for inspect */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) /* loading for inspect */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:29:47.793482', '2025-06-26 20:29:47.793482'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:29:47.793482', '2025-06-26 20:29:47.793482'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:29:47.793482', '2025-06-26 20:29:47.793482'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:29:47.793482', '2025-06-26 20:29:47.793482')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (17.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (5.6ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.6ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.6ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:29:47.901082"], ["updated_at", "2025-06-26 20:29:47.901082"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:29:47.902388"], ["updated_at", "2025-06-26 20:29:47.902388"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:29:47.903165"], ["updated_at", "2025-06-26 20:29:47.903165"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:29:47.903915"], ["updated_at", "2025-06-26 20:29:47.903915"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160650], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160652], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160650], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160651], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:29:47.913320"], ["updated_at", "2025-06-26 20:29:47.913320"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:29:47.914208"], ["updated_at", "2025-06-26 20:29:47.914208"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:29:47.915217"], ["updated_at", "2025-06-26 20:29:47.915217"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:29:47.916036"], ["updated_at", "2025-06-26 20:29:47.916036"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:29:47.921011"], ["updated_at", "2025-06-26 20:29:47.921011"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:29:47.922061"], ["updated_at", "2025-06-26 20:29:47.922061"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:29:47.922823"], ["updated_at", "2025-06-26 20:29:47.922823"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:29:47.923597"], ["updated_at", "2025-06-26 20:29:47.923597"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.5ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:29:47.928037"], ["updated_at", "2025-06-26 20:29:47.928037"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:29:47.928829"], ["updated_at", "2025-06-26 20:29:47.928829"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:29:47.929643"], ["updated_at", "2025-06-26 20:29:47.929643"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:29:47.930442"], ["updated_at", "2025-06-26 20:29:47.930442"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160662], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160665], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160665], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.3ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:37:21.706790', '2025-06-26 20:37:21.706790'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:37:21.706790', '2025-06-26 20:37:21.706790'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:37:21.706790', '2025-06-26 20:37:21.706790'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:37:21.706790', '2025-06-26 20:37:21.706790')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (13.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.9ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:21.753257"], ["updated_at", "2025-06-26 20:37:21.753257"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.8ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:21.755267"], ["updated_at", "2025-06-26 20:37:21.755267"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:21.756727"], ["updated_at", "2025-06-26 20:37:21.756727"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:21.757488"], ["updated_at", "2025-06-26 20:37:21.757488"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:37:21.758955', '2025-06-26 20:37:21.758955'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:37:21.758955', '2025-06-26 20:37:21.758955'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:37:21.758955', '2025-06-26 20:37:21.758955'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:37:21.758955', '2025-06-26 20:37:21.758955')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:21.764198"], ["updated_at", "2025-06-26 20:37:21.764198"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:21.765785"], ["updated_at", "2025-06-26 20:37:21.765785"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:21.766507"], ["updated_at", "2025-06-26 20:37:21.766507"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:21.767635"], ["updated_at", "2025-06-26 20:37:21.767635"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160650], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:37:21.773417', '2025-06-26 20:37:21.773417'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:37:21.773417', '2025-06-26 20:37:21.773417'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:37:21.773417', '2025-06-26 20:37:21.773417'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:37:21.773417', '2025-06-26 20:37:21.773417')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:21.778575"], ["updated_at", "2025-06-26 20:37:21.778575"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:21.779412"], ["updated_at", "2025-06-26 20:37:21.779412"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:21.780118"], ["updated_at", "2025-06-26 20:37:21.780118"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:21.780779"], ["updated_at", "2025-06-26 20:37:21.780779"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (1002160649, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:37:21.781959', '2025-06-26 20:37:21.781959'), (582128565, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:37:21.781959', '2025-06-26 20:37:21.781959'), (364225320, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:37:21.781959', '2025-06-26 20:37:21.781959'), (198260359, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:37:21.781959', '2025-06-26 20:37:21.781959')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.3ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 1002160649]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.2ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 582128565]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 364225320]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Destroy (0.1ms)[0m  [1m[31mDELETE FROM "recipes" WHERE "recipes"."id" = $1[0m  [["id", 198260359]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:21.787842"], ["updated_at", "2025-06-26 20:37:21.787842"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:21.788800"], ["updated_at", "2025-06-26 20:37:21.788800"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:21.789506"], ["updated_at", "2025-06-26 20:37:21.789506"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:21.790166"], ["updated_at", "2025-06-26 20:37:21.790166"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160650], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160652], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160650], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160651], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1002160653], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.8ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:46.459648"], ["updated_at", "2025-06-26 20:37:46.459648"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:46.463268"], ["updated_at", "2025-06-26 20:37:46.463268"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:46.464009"], ["updated_at", "2025-06-26 20:37:46.464009"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:46.464700"], ["updated_at", "2025-06-26 20:37:46.464700"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:46.469315"], ["updated_at", "2025-06-26 20:37:46.469315"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:46.470762"], ["updated_at", "2025-06-26 20:37:46.470762"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:46.471440"], ["updated_at", "2025-06-26 20:37:46.471440"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:46.472129"], ["updated_at", "2025-06-26 20:37:46.472129"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.0ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.0ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:46.479616"], ["updated_at", "2025-06-26 20:37:46.479616"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:46.480401"], ["updated_at", "2025-06-26 20:37:46.480401"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:46.481046"], ["updated_at", "2025-06-26 20:37:46.481046"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:46.481670"], ["updated_at", "2025-06-26 20:37:46.481670"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:37:46.486759"], ["updated_at", "2025-06-26 20:37:46.486759"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:37:46.487678"], ["updated_at", "2025-06-26 20:37:46.487678"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:37:46.489138"], ["updated_at", "2025-06-26 20:37:46.489138"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (1.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:37:46.489846"], ["updated_at", "2025-06-26 20:37:46.489846"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.3ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.7ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
  [1m[36mRecipe Load (1.0ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (1.9ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.149647"], ["updated_at", "2025-06-26 20:38:58.149647"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.155385"], ["updated_at", "2025-06-26 20:38:58.155385"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.156762"], ["updated_at", "2025-06-26 20:38:58.156762"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.7ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.157756"], ["updated_at", "2025-06-26 20:38:58.157756"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 22:38:58 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (1.0ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%'))[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 1.0ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.223070"], ["updated_at", "2025-06-26 20:38:58.223070"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.224644"], ["updated_at", "2025-06-26 20:38:58.224644"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.225772"], ["updated_at", "2025-06-26 20:38:58.225772"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.227190"], ["updated_at", "2025-06-26 20:38:58.227190"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 22:38:58 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 1.6ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.242089"], ["updated_at", "2025-06-26 20:38:58.242089"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.6ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.243637"], ["updated_at", "2025-06-26 20:38:58.243637"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.245166"], ["updated_at", "2025-06-26 20:38:58.245166"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.246301"], ["updated_at", "2025-06-26 20:38:58.246301"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 22:38:58 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.256013"], ["updated_at", "2025-06-26 20:38:58.256013"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.257109"], ["updated_at", "2025-06-26 20:38:58.257109"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.258218"], ["updated_at", "2025-06-26 20:38:58.258218"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.6ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.259283"], ["updated_at", "2025-06-26 20:38:58.259283"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 22:38:58 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.271379"], ["updated_at", "2025-06-26 20:38:58.271379"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.272601"], ["updated_at", "2025-06-26 20:38:58.272601"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.273475"], ["updated_at", "2025-06-26 20:38:58.273475"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.274343"], ["updated_at", "2025-06-26 20:38:58.274343"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 22:38:58 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.283572"], ["updated_at", "2025-06-26 20:38:58.283572"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.285059"], ["updated_at", "2025-06-26 20:38:58.285059"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.286631"], ["updated_at", "2025-06-26 20:38:58.286631"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.288516"], ["updated_at", "2025-06-26 20:38:58.288516"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.296296"], ["updated_at", "2025-06-26 20:38:58.296296"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.297614"], ["updated_at", "2025-06-26 20:38:58.297614"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.298610"], ["updated_at", "2025-06-26 20:38:58.298610"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.299718"], ["updated_at", "2025-06-26 20:38:58.299718"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.307612"], ["updated_at", "2025-06-26 20:38:58.307612"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.308880"], ["updated_at", "2025-06-26 20:38:58.308880"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.309963"], ["updated_at", "2025-06-26 20:38:58.309963"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.311035"], ["updated_at", "2025-06-26 20:38:58.311035"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:38:58.322396"], ["updated_at", "2025-06-26 20:38:58.322396"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:38:58.323468"], ["updated_at", "2025-06-26 20:38:58.323468"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:38:58.324354"], ["updated_at", "2025-06-26 20:38:58.324354"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:38:58.325247"], ["updated_at", "2025-06-26 20:38:58.325247"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.7ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.8ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (15.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (1.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.628336"], ["updated_at", "2025-06-26 20:45:12.628336"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.632317"], ["updated_at", "2025-06-26 20:45:12.632317"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.633198"], ["updated_at", "2025-06-26 20:45:12.633198"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.634002"], ["updated_at", "2025-06-26 20:45:12.634002"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.644326"], ["updated_at", "2025-06-26 20:45:12.644326"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.645224"], ["updated_at", "2025-06-26 20:45:12.645224"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.646004"], ["updated_at", "2025-06-26 20:45:12.646004"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.646777"], ["updated_at", "2025-06-26 20:45:12.646777"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mRecipe Load (0.0ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.651200"], ["updated_at", "2025-06-26 20:45:12.651200"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.652047"], ["updated_at", "2025-06-26 20:45:12.652047"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.652879"], ["updated_at", "2025-06-26 20:45:12.652879"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.653929"], ["updated_at", "2025-06-26 20:45:12.653929"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.0ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.658876"], ["updated_at", "2025-06-26 20:45:12.658876"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.659817"], ["updated_at", "2025-06-26 20:45:12.659817"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.660596"], ["updated_at", "2025-06-26 20:45:12.660596"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.661384"], ["updated_at", "2025-06-26 20:45:12.661384"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.702328"], ["updated_at", "2025-06-26 20:45:12.702328"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.703673"], ["updated_at", "2025-06-26 20:45:12.703673"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.704564"], ["updated_at", "2025-06-26 20:45:12.704564"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.1ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.705234"], ["updated_at", "2025-06-26 20:45:12.705234"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 22:45:12 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
Completed 200 OK in 7ms (Views: 1.1ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.759676"], ["updated_at", "2025-06-26 20:45:12.759676"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.760827"], ["updated_at", "2025-06-26 20:45:12.760827"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.761746"], ["updated_at", "2025-06-26 20:45:12.761746"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.2ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.762796"], ["updated_at", "2025-06-26 20:45:12.762796"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 22:45:12 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.1ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mCOMMIT[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.771207"], ["updated_at", "2025-06-26 20:45:12.771207"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.772529"], ["updated_at", "2025-06-26 20:45:12.772529"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.773524"], ["updated_at", "2025-06-26 20:45:12.773524"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.774571"], ["updated_at", "2025-06-26 20:45:12.774571"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 22:45:12 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.6ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.786372"], ["updated_at", "2025-06-26 20:45:12.786372"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.787808"], ["updated_at", "2025-06-26 20:45:12.787808"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.789077"], ["updated_at", "2025-06-26 20:45:12.789077"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.790093"], ["updated_at", "2025-06-26 20:45:12.790093"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 22:45:12 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.2ms)[0m  [1m[31mDELETE FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.9ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Sugar Cookies"], ["cook_time", 15], ["prep_time", 20], ["ingredients", "{\"1 cup sugar\",\"2 cups flour\",\"1 egg\",\"1 tsp vanilla\"}"], ["ratings", "4.5"], ["cuisine", "Dessert"], ["category", "Cookies"], ["author", "Cookie Monster"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies"], ["created_at", "2025-06-26 20:45:12.801451"], ["updated_at", "2025-06-26 20:45:12.801451"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.4ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Flour Tortillas"], ["cook_time", 10], ["prep_time", 10], ["ingredients", "{\"2 cups all-purpose flour\",\"1/2 cup water\",\"1/2 tsp salt\"}"], ["ratings", "4.2"], ["cuisine", "Mexican"], ["category", "Bread"], ["author", "Maria"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas"], ["created_at", "2025-06-26 20:45:12.802624"], ["updated_at", "2025-06-26 20:45:12.802624"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.3ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Egg Scramble"], ["cook_time", 5], ["prep_time", 2], ["ingredients", "{\"3 eggs\",\"1 tbsp milk\",salt,pepper}"], ["ratings", "3.9"], ["cuisine", "Breakfast"], ["category", "Eggs"], ["author", "Chef John"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble"], ["created_at", "2025-06-26 20:45:12.803699"], ["updated_at", "2025-06-26 20:45:12.803699"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRecipe Create (0.5ms)[0m  [1m[32mINSERT INTO "recipes" ("title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["title", "Vanilla Cake"], ["cook_time", 30], ["prep_time", 15], ["ingredients", "{\"1 cup flour\",\"1 cup sugar\",\"2 eggs\",\"1 tsp vanilla extract\",\"1/2 cup milk\"}"], ["ratings", "4.8"], ["cuisine", "Dessert"], ["category", "Cake"], ["author", "Betty Baker"], ["image", "https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake"], ["created_at", "2025-06-26 20:45:12.804708"], ["updated_at", "2025-06-26 20:45:12.804708"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT[0m
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 22:45:12 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 20:57:40.980451', '2025-06-26 20:57:40.980451'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 20:57:40.980451', '2025-06-26 20:57:40.980451'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 20:57:40.980451', '2025-06-26 20:57:40.980451'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 20:57:40.980451', '2025-06-26 20:57:40.980451'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 20:57:40.980451', '2025-06-26 20:57:40.980451')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (10.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 22:57:41 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (6.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%kale%'))[0m
Completed 200 OK in 17ms (Views: 0.3ms | ActiveRecord: 6.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 22:57:41 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.8ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%milk%'))[0m
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 22:57:41 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 22:57:41 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 22:57:41 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) LIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.3ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (14.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:13:53.030215', '2025-06-26 21:13:53.030215'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:13:53.030215', '2025-06-26 21:13:53.030215'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:13:53.030215', '2025-06-26 21:13:53.030215'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:13:53.030215', '2025-06-26 21:13:53.030215'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:13:53.030215', '2025-06-26 21:13:53.030215')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (3.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (53.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:13:53 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (1.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%'))[0m
Completed 200 OK in 20ms (Views: 13.2ms | ActiveRecord: 1.6ms (1 query, 0 cached) | GC: 11.8ms)
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:13:53 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:13:53 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:13:53 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (1.9ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%'))[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 1.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:13:53 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.1ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:14:19.352472', '2025-06-26 21:14:19.352472'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:14:19.352472', '2025-06-26 21:14:19.352472'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:14:19.352472', '2025-06-26 21:14:19.352472'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:14:19.352472', '2025-06-26 21:14:19.352472'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:14:19.352472', '2025-06-26 21:14:19.352472')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (10.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:14:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.7ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%chocolate%'))[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:14:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.7ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:14:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%'))[0m
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:14:19 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.5ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:14:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%'))[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.7ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:14:36.934025', '2025-06-26 21:14:36.934025'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:14:36.934025', '2025-06-26 21:14:36.934025'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:14:36.934025', '2025-06-26 21:14:36.934025'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:14:36.934025', '2025-06-26 21:14:36.934025'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:14:36.934025', '2025-06-26 21:14:36.934025')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.9ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:14:37 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.9ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%kale%'))[0m
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:14:37 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:14:37 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%'))[0m
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:14:37 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:14:37 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%egg%'))[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (6.3ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:16:23.414595', '2025-06-26 21:16:23.414595'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:16:23.414595', '2025-06-26 21:16:23.414595'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:16:23.414595', '2025-06-26 21:16:23.414595'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:16:23.414595', '2025-06-26 21:16:23.414595'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:16:23.414595', '2025-06-26 21:16:23.414595')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.9ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:16:23 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%kale%'))[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:16:23 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%milk%'))[0m
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:16:23 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:16:23 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:16:23 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:27:53.902272', '2025-06-26 21:27:53.902272'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:27:53.902272', '2025-06-26 21:27:53.902272'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:27:53.902272', '2025-06-26 21:27:53.902272'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:27:53.902272', '2025-06-26 21:27:53.902272'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:27:53.902272', '2025-06-26 21:27:53.902272')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:27:53 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (2.8ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%kale%'))[0m
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 2.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:27:54 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.7ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 8ms (Views: 1.4ms | ActiveRecord: 0.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:27:54 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:27:54 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:27:54 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.4ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:33:26.567856', '2025-06-26 21:33:26.567856'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:33:26.567856', '2025-06-26 21:33:26.567856'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:33:26.567856', '2025-06-26 21:33:26.567856'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:33:26.567856', '2025-06-26 21:33:26.567856'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:33:26.567856', '2025-06-26 21:33:26.567856')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (9.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.8ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:33:26 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (3.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%'))[0m
Completed 200 OK in 10ms (Views: 1.1ms | ActiveRecord: 3.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:33:26 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:33:26 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:33:26 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:33:26 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE LOWER(ingredient::text) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.3ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:39:41.964582', '2025-06-26 21:39:41.964582'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:39:41.964582', '2025-06-26 21:39:41.964582'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:39:41.964582', '2025-06-26 21:39:41.964582'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:39:41.964582', '2025-06-26 21:39:41.964582'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:39:41.964582', '2025-06-26 21:39:41.964582')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (11.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.7ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:39:42 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.8ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%'))[0m
Completed 200 OK in 8ms (Views: 1.2ms | ActiveRecord: 0.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:39:42 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:39:42 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:39:42 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:39:42 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.6ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:41:25.879195', '2025-06-26 21:41:25.879195'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:41:25.879195', '2025-06-26 21:41:25.879195'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:41:25.879195', '2025-06-26 21:41:25.879195'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:41:25.879195', '2025-06-26 21:41:25.879195'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:41:25.879195', '2025-06-26 21:41:25.879195')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:41:25 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (1.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%'))[0m
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.7ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:41:25 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:41:26 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%'))[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:41:26 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:41:26 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.8ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:49:07.350556', '2025-06-26 21:49:07.350556'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:49:07.350556', '2025-06-26 21:49:07.350556'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:49:07.350556', '2025-06-26 21:49:07.350556'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:49:07.350556', '2025-06-26 21:49:07.350556'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:49:07.350556', '2025-06-26 21:49:07.350556')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (10.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (1.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:49:07 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (3.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%'))[0m
Completed 200 OK in 10ms (Views: 1.2ms | ActiveRecord: 3.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:49:07 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:49:07 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%'))[0m
Completed 200 OK in 0ms (Views: 0.0ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'any'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=sugar%2Cmilk&match_all=false" for 127.0.0.1 at 2025-06-26 23:49:07 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "sugar,milk", "match_all" => "false"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:49:07 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (50557508, 'Sugar Cookies', 15, 20, '{"1 cup sugar","2 cups flour","1 egg","1 tsp vanilla"}', 4.5, 'Dessert', 'Cookies', 'Cookie Monster', 'https://placehold.co/400x300/F0F8FF/000000?text=Sugar+Cookies', '2025-06-26 21:51:19.475603', '2025-06-26 21:51:19.475603'), (875690034, 'Flour Tortillas', 10, 10, '{"2 cups all-purpose flour","1/2 cup water","1/2 tsp salt"}', 4.2, 'Mexican', 'Bread', 'Maria', 'https://placehold.co/400x300/F0F8FF/000000?text=Flour+Tortillas', '2025-06-26 21:51:19.475603', '2025-06-26 21:51:19.475603'), (548240562, 'Egg Scramble', 5, 2, '{"3 eggs","1 tbsp milk",salt,pepper}', 3.9, 'Breakfast', 'Eggs', 'Chef John', 'https://placehold.co/400x300/F0F8FF/000000?text=Egg+Scramble', '2025-06-26 21:51:19.475603', '2025-06-26 21:51:19.475603'), (939024767, 'Vanilla Cake', 30, 15, '{"1 cup flour","1 cup sugar","2 eggs","1 tsp vanilla extract","1/2 cup milk"}', 4.8, 'Dessert', 'Cake', 'Betty Baker', 'https://placehold.co/400x300/F0F8FF/000000?text=Vanilla+Cake', '2025-06-26 21:51:19.475603', '2025-06-26 21:51:19.475603'), (111809144, 'Empty Test Recipe', 0, 0, '{}', 0.0, '', '', '', '', '2025-06-26 21:51:19.475603', '2025-06-26 21:51:19.475603')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_returns_recipes_matching_any_keyword
----------------------------------------------------------------------------
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 548240562], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') OR EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%milk%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 875690034], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_returns_recipes_matching_all_keywords
------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 111809144], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%')) AND "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
  [1m[36mRecipe Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%egg%'))[0m
  [1m[36mRecipe Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%')) LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RecipeTest: test_find_by_all_ingredients_handles_empty_keywords
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RecipeTest: test_find_by_any_ingredient_handles_empty_keywords
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'any'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=kale&match_all=false" for 127.0.0.1 at 2025-06-26 23:51:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "kale", "match_all" => "false"}
  [1m[36mRecipe Load (0.6ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%kale%'))[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_all_recipes_if_no_keywords_are_provided
---------------------------------------------------------------------------------
Started GET "/recipes/search" for 127.0.0.1 at 2025-06-26 23:51:19 +0200
Processing by RecipesController#search as HTML
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes"[0m
Completed 200 OK in 2ms (Views: 1.2ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------------------------
RecipesControllerTest: test_should_get_search_results_for_'all'_matching_ingredients
------------------------------------------------------------------------------------
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 50557508], ["LIMIT", 1]]
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 939024767], ["LIMIT", 1]]
Started GET "/recipes/search?keywords=flour%2Csugar&match_all=true" for 127.0.0.1 at 2025-06-26 23:51:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "flour,sugar", "match_all" => "true"}
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%flour%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%sugar%'))[0m
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------
RecipesControllerTest: test_should_return_empty_array_if_no_matching_recipes_for_'all'_keywords
-----------------------------------------------------------------------------------------------
Started GET "/recipes/search?keywords=banana%2Cchocolate&match_all=true" for 127.0.0.1 at 2025-06-26 23:51:19 +0200
Processing by RecipesController#search as HTML
  Parameters: {"keywords" => "banana,chocolate", "match_all" => "true"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%banana%') AND EXISTS (SELECT 1 FROM unnest(ingredients) AS ingredient WHERE TRIM(LOWER(ingredient::text)) ILIKE '%chocolate%'))[0m
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (3.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (3.9ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (159314246, 'Chicken and Rice Stir Fry', 20, 15, '{"chicken breast","white rice","soy sauce",broccoli,onion,garlic}', 4.5, 'Asian', 'Dinner', 'Test Cook', 'http://example.com/stir_fry.jpg', '2025-06-27 07:08:50.717019', '2025-06-27 07:08:50.717019'), (656024805, 'Simple Tomato Soup', 30, 5, '{"canned tomatoes","vegetable broth",basil,garlic,onion}', 4.0, 'Italian', 'Soup', 'Soup Master', 'http://example.com/tomato_soup.jpg', '2025-06-27 07:08:50.717019', '2025-06-27 07:08:50.717019'), (225341648, 'Hearty Beef Stew', 2, 30, '{"beef chunks",potatoes,carrots,celery,"beef broth",thyme}', 4.8, 'Comfort Food', 'Main Dish', 'Grandma', 'http://example.com/beef_stew.jpg', '2025-06-27 07:08:50.717019', '2025-06-27 07:08:50.717019')[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (17.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_recipes_matching_multiple_ingredients_case_insensitively
-----------------------------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=Chicken%2C+rICE" for 127.0.0.1 at 2025-06-27 09:08:50 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "Chicken, rICE"}
  [1m[36mRecipe Load (2.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%chicken%"], [nil, "%rice%"]]
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 2.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Load (0.5ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 159314246], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_recipes_matching_multiple_ingredients
----------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=chicken%2C+rice" for 127.0.0.1 at 2025-06-27 09:08:50 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "chicken, rice"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%chicken%"], [nil, "%rice%"]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 159314246], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_no_recipes_if_partial_match_not_enough
-----------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=chicken%2C+potato" for 127.0.0.1 at 2025-06-27 09:08:50 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "chicken, potato"}
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%chicken%"], [nil, "%potato%"]]
Completed 200 OK in 0ms (Views: 0.0ms | ActiveRecord: 0.2ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
Api::V1::RecipesControllerTest: test_should_get_index
-----------------------------------------------------
Started GET "/api/v1/recipes" for 127.0.0.1 at 2025-06-27 09:08:50 +0200
Processing by Api::V1::RecipesController#index as HTML
Completed 200 OK in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_no_recipes_if_no_match
-------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=pizza%2C+pasta" for 127.0.0.1 at 2025-06-27 09:08:50 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "pizza, pasta"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%pizza%"], [nil, "%pasta%"]]
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_recipes_matching_single_ingredient
-------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=chicken" for 127.0.0.1 at 2025-06-27 09:08:50 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "chicken"}
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1))[0m  [[nil, "%chicken%"]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 159314246], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "recipes" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.4ms)[0m  [1m[31mDELETE FROM "recipes";
INSERT INTO "recipes" ("id", "title", "cook_time", "prep_time", "ingredients", "ratings", "cuisine", "category", "author", "image", "created_at", "updated_at") VALUES (159314246, 'Chicken and Rice Stir Fry', 20, 15, '{"chicken breast","white rice","soy sauce",broccoli,onion,garlic}', 4.5, 'Asian', 'Dinner', 'Test Cook', 'http://example.com/stir_fry.jpg', '2025-06-27 07:09:07.072050', '2025-06-27 07:09:07.072050'), (656024805, 'Simple Tomato Soup', 30, 5, '{"canned tomatoes","vegetable broth",basil,garlic,onion}', 4.0, 'Italian', 'Soup', 'Soup Master', 'http://example.com/tomato_soup.jpg', '2025-06-27 07:09:07.072050', '2025-06-27 07:09:07.072050'), (225341648, 'Hearty Beef Stew', 2, 30, '{"beef chunks",potatoes,carrots,celery,"beef broth",thyme}', 4.8, 'Comfort Food', 'Main Dish', 'Grandma', 'http://example.com/beef_stew.jpg', '2025-06-27 07:09:07.072050', '2025-06-27 07:09:07.072050')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "recipes" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (3.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (17.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_no_recipes_if_partial_match_not_enough
-----------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=chicken%2C+potato" for 127.0.0.1 at 2025-06-27 09:09:07 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "chicken, potato"}
  [1m[36mRecipe Load (1.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%chicken%"], [nil, "%potato%"]]
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_recipes_matching_multiple_ingredients
----------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=chicken%2C+rice" for 127.0.0.1 at 2025-06-27 09:09:07 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "chicken, rice"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%chicken%"], [nil, "%rice%"]]
Completed 200 OK in 7ms (Views: 0.1ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Load (0.4ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 159314246], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_recipes_matching_single_ingredient
-------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=chicken" for 127.0.0.1 at 2025-06-27 09:09:07 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "chicken"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1))[0m  [[nil, "%chicken%"]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Load (0.1ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 159314246], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_recipes_matching_multiple_ingredients_case_insensitively
-----------------------------------------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=Chicken%2C+rICE" for 127.0.0.1 at 2025-06-27 09:09:07 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "Chicken, rICE"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%chicken%"], [nil, "%rice%"]]
Completed 200 OK in 1ms (Views: 0.0ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mRecipe Load (0.2ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE "recipes"."id" = $1 LIMIT $2[0m  [["id", 159314246], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------
Api::V1::RecipesControllerTest: test_should_return_no_recipes_if_no_match
-------------------------------------------------------------------------
Started GET "/api/v1/recipes?ingredients=pizza%2C+pasta" for 127.0.0.1 at 2025-06-27 09:09:07 +0200
Processing by Api::V1::RecipesController#index as HTML
  Parameters: {"ingredients" => "pizza, pasta"}
  [1m[36mRecipe Load (0.3ms)[0m  [1m[34mSELECT "recipes".* FROM "recipes" WHERE (EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $1) AND EXISTS (SELECT 1 FROM unnest(recipes.ingredients) AS ri WHERE ri ILIKE $2))[0m  [[nil, "%pizza%"], [nil, "%pasta%"]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
Api::V1::RecipesControllerTest: test_should_get_index
-----------------------------------------------------
Started GET "/api/v1/recipes" for 127.0.0.1 at 2025-06-27 09:09:07 +0200
Processing by Api::V1::RecipesController#index as HTML
Completed 200 OK in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
